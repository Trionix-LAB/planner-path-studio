# –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–π –∞—É–¥–∏—Ç ‚Äî Planner Path Studio

–î–∞—Ç–∞: 2026-02-13
–ê–≤—Ç–æ—Ä: –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∞—É–¥–∏—Ç (scope: –∫–æ–¥–æ–≤–∞—è –±–∞–∑–∞)

## –ö—Ä–∞—Ç–∫–æ–µ —Ä–µ–∑—é–º–µ ‚úÖ
- –í –ø—Ä–æ–µ–∫—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –≤—ã–¥–µ–ª–µ–Ω—ã `platform` –∏ –¥–æ–º–µ–Ω–Ω—ã–µ —Å–ª–æ–∏; –¥–æ–º–µ–Ω–Ω–∞—è –ª–æ–≥–∏–∫–∞ —Ö–æ—Ä–æ—à–æ –ø–æ–∫—Ä—ã—Ç–∞ —Ç–µ—Å—Ç–∞–º–∏.
- –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —Ä–∏—Å–∫–∏: Electron IPC/FS-–ø—Ä–∞–≤–∞ –∏ –æ—Ç–∫—Ä—ã—Ç—ã–µ –≤–Ω–µ—à–Ω–∏–µ URL ‚Äî —Ç—Ä–µ–±—É—é—Ç –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ–≥–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è (P0).
- –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –æ—Ö–≤–∞—Ç—ã–≤–∞—é—Ç –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å, –≥—Ä–∞–Ω–∏—Ü—ã –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏ (DIP/SRP), DRY –∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å (—Ç–µ–ª–µ–º–µ—Ç—Ä–∏—è, —Ñ–∞–π–ª–æ–≤—ã–π –ª–∏—Å—Ç–∏–Ω–≥).

---

## –û–±–ª–∞—Å—Ç—å –ø—Ä–æ–≤–µ—Ä–∫–∏
- –í—Ö–æ–¥–Ω—ã–µ —Ç–æ—á–∫–∏ Electron: `electron/main.cjs`, `electron/preload.cjs`.
- –ü–ª–∞—Ç—Ñ–æ—Ä–º–µ–Ω–Ω–∞—è –∞–±—Å—Ç—Ä–∞–∫—Ü–∏—è: `src/platform/*`.
- –î–æ–º–µ–Ω –º–∏—Å—Å–∏–π –∏ —Ç–µ–ª–µ–º–µ—Ç—Ä–∏–∏: `src/features/mission/model/*`.
- UI entry / –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è: `src/main.tsx`, `src/App.tsx`, `src/platform/router.tsx`.
- –°–±–æ—Ä–∫–∞/—Å–∫—Ä–∏–ø—Ç—ã: `package.json`, `vite.config.ts`.

## –û—Å–Ω–æ–≤–Ω—ã–µ –≤—ã–≤–æ–¥—ã (–ø—Ä–∏–≤—è–∑–∫–∞ –∫ —Ñ–∞–π–ª–∞–º) üîé
- Security (P0)
  - –ü—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫ —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ —á–µ—Ä–µ–∑ `fileStore` (main/preload) ‚Äî `electron/main.cjs`, `electron/preload.cjs`, `src/platform/electron/platform.ts`.
  - `shell.openExternal` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –±–µ–∑ allowlist ‚Äî `electron/main.cjs`.
  - `webPreferences.sandbox` –Ω–µ –≤–∫–ª—é—á—ë–Ω; `devTools: true` –≤–∫–ª—é—á—ë–Ω –≤—Å–µ–≥–¥–∞ ‚Äî `electron/main.cjs`.

- –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ / SOLID (P1)
  - Telemetry –Ω–∞–ø—Ä—è–º—É—é –æ–±—Ä–∞—â–∞–µ—Ç—Å—è –∫ `window.electronAPI` (–Ω–∞—Ä—É—à–µ–Ω–∏–µ DIP) ‚Äî `src/features/mission/model/telemetry.ts`.
  - `main.cjs` –∏ `MapWorkspace.tsx` ‚Äî –±–æ–ª—å—à–∏–µ —Ñ–∞–π–ª—ã —Å –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—è–º–∏ (SRP) ‚Äî `electron/main.cjs`, `src/pages/MapWorkspace.tsx`.
  - –î—É–±–ª–∏ `CHANNELS`/bridge-—Ç–∏–ø–æ–≤ –º–µ–∂–¥—É main/preload/renderer ‚Äî —Ä–∏—Å–∫ —Ä–∞—Å—Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ ‚Äî `electron/*`, `src/vite-env.d.ts`.
  - UI-—Å—Ç—Ä–æ–∫–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–ª—è –ª–æ–≥–∏–∫–∏ –∑–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è –ø—É—Ç–µ–π (`title.includes('–º–∏—Å—Å–∏')`) ‚Äî `src/platform/electron/platform.ts`.

- –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å (P2)
  - –†–µ–∫—É—Ä—Å–∏–≤–Ω—ã–π `fileStore.list` (walkDir) –º–æ–∂–µ—Ç –±—ã—Ç—å –¥–æ—Ä–æ–≥ –¥–ª—è –±–æ–ª—å—à–∏—Ö –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π ‚Äî `electron/main.cjs`.
  - UDP ‚Üí IPC ‚Üí –ø–∞—Ä—Å–∏–Ω–≥ –≤ renderer –±–µ–∑ —Ç—Ä–æ—Ç—Ç–ª–∏–Ω–≥–∞/–±–∞—Ç—á–∏–Ω–≥–∞ ‚Äî –≤–æ–∑–º–æ–∂–Ω—ã–π jank –ø—Ä–∏ –≤—ã—Å–æ–∫–æ–π —á–∞—Å—Ç–æ—Ç–µ ‚Äî `electron/main.cjs`, `src/features/mission/model/telemetry.ts`.
  - –ë–æ–ª—å—à–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã/—Ö—É–∫–∏ –ø—Ä–∏–≤–æ–¥—è—Ç –∫ –ª–∏—à–Ω–∏–º —Ä–µ—Ä–µ–Ω–¥–µ—Ä–∞–º ‚Äî `src/pages/MapWorkspace.tsx`.

## –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ ‚Äî –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã –∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –ø—Ä–∞–≤–∫–∏ üîß
- P0 ‚Äî Security (—Å–¥–µ–ª–∞—Ç—å –≤ –±–ª–∏–∂–∞–π—à–µ–º —Ä–µ–ª–∏–∑–µ)
  1. –û–≥—Ä–∞–Ω–∏—á–∏—Ç—å `fileStore` –æ–ø–µ—Ä–∞—Ü–∏—è–º–∏ –≤–Ω—É—Ç—Ä–∏ allowlist –∫–æ—Ä–Ω–µ–π (–Ω–∞–ø—Ä–∏–º–µ—Ä, `missionsDir`, `exportsDir`, `userData/planner.fs`) ‚Äî —Ñ–∞–π–ª—ã: `electron/main.cjs`, `electron/preload.cjs`, `src/platform/electron/platform.ts`.
  2. –í–≤–µ—Å—Ç–∏ allowlist —Å—Ö–µ–º/–¥–æ–º–µ–Ω–æ–≤ –≤ `setWindowOpenHandler` –∏ –≤–∞–ª–∏–¥–∏—Ä–æ–≤–∞—Ç—å URL-—Å—Ö–µ–º—É ‚Äî `electron/main.cjs`.
  3. –í–∫–ª—é—á–∏—Ç—å `sandbox: true` –≤ `webPreferences` –¥–ª—è production –∏ –≤—ã–∫–ª—é—á–∞—Ç—å `devTools` –≤ –ø—Ä–æ–¥–µ ‚Äî `electron/main.cjs`.

- P1 ‚Äî –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ / SOLID
  1. –ü–µ—Ä–µ–Ω–µ—Å—Ç–∏ –¥–æ—Å—Ç—É–ø –∫ `electronAPI` –≤ –µ–¥–∏–Ω—É—é –ø—Ä–æ—Å–ª–æ–π–∫—É/—Ñ–∞–±—Ä–∏–∫—É (platform) –∏ —É–±—Ä–∞—Ç—å –ø—Ä—è–º—ã–µ –æ–±—Ä–∞—â–µ–Ω–∏—è –∏–∑ –¥–æ–º–µ–Ω–∞ (`telemetry.ts`) ‚Äî `src/platform/*`, `src/features/mission/model/telemetry.ts`.
  2. –í—ã–Ω–µ—Å—Ç–∏ `CHANNELS`/–∫–æ–Ω—Ç—Ä–∞–∫—Ç—ã –≤ –æ–¥–∏–Ω TS-–º–æ–¥—É–ª—å –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –µ–≥–æ –≤ main/preload/renderer (`src/platform/contracts.ts` –∏–ª–∏ `src/platform/ipc-contracts.ts`).
  3. –†–∞–∑–±–∏—Ç—å `electron/main.cjs` –ø–æ –º–æ–¥—É–ª—è–º (fs, ipc, device-bridges) –∏ —É–º–µ–Ω—å—à–∏—Ç—å —Ä–∞–∑–º–µ—Ä `MapWorkspace.tsx` (—Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –ª–æ–≥–∏–∫–∏ –Ω–∞ —Ö—É–∫–∏/–∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä—ã).

- P2 ‚Äî –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å / UX
  1. –û–≥—Ä–∞–Ω–∏—á–∏—Ç—å/—Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å `fileStore.list` (–Ω–µ –¥–µ–ª–∞—Ç—å –æ–±—â–∏–π —Ä–µ–∫—É—Ä—Å–∏–≤–Ω—ã–π –æ–±—Ö–æ–¥) –∏–ª–∏ –¥–æ–±–∞–≤–∏—Ç—å –ø–∞–≥–∏–Ω–∞—Ü–∏—é/–≥–ª—É–±–∏–Ω—É –ø–æ–∏—Å–∫–∞ ‚Äî `electron/main.cjs`.
  2. –ë–∞—Ç—á–∏–Ω–≥/—Ç—Ä–æ—Ç—Ç–ª–∏–Ω–≥ UDP‚ÜíIPC —Å–æ–±—ã—Ç–∏–π –∏–ª–∏ –ø–∞—Ä—Å–∏–Ω–≥ –≤ main/worker ‚Äî `electron/main.cjs`, `src/features/mission/model/telemetry.ts`.
  3. Lazy-load –±–æ–ª—å—à–∏—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ –∏ memoization –≤ `MapWorkspace`.

## –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ acceptance-criteria (–ø—Ä–∏–º–µ—Ä –¥–ª—è P0)
- `fileStore` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ—à–∏–±–∫—É/–ø—É—Å—Ç–æ–π –æ—Ç–≤–µ—Ç –ø—Ä–∏ –ø–æ–ø—ã—Ç–∫–µ –¥–æ—Å—Ç—É–ø–∞ –∑–∞ –ø—Ä–µ–¥–µ–ª—ã allowlist –∫–æ—Ä–Ω–µ–π.
- –í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π –±—Ä–∞—É–∑–µ—Ä –Ω–µ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç URL-—ã —Å –Ω–µ–±–µ–∑–æ–ø–∞—Å–Ω—ã—Ö —Å—Ö–µ–º; –≤ prod `devTools` –æ—Ç–∫–ª—é—á–µ–Ω—ã.
- Unit-—Ç–µ—Å—Ç—ã –ø–æ–∫—Ä—ã–≤–∞—é—Ç —Ä–∞–∑—Ä–µ—à—ë–Ω–Ω—ã–µ/–∑–∞–ø—Ä–µ—â—ë–Ω–Ω—ã–µ FS-–æ–ø–µ—Ä–∞—Ü–∏–∏ –∏ URL-allowlist.

## –ü—Ä–µ–¥–ª–æ–∂–µ–Ω–Ω—ã–π –ø–ª–∞–Ω —Ä–∞–±–æ—Ç (–º–∏–∫—Ä–æ–∑–∞–¥–∞—á–∏)
1. P0 patch: –¥–æ–±–∞–≤–∏—Ç—å FS allowlist + URL allowlist + sandbox/devTools change (PR1, ~1‚Äì2 –¥–Ω—è).
2. P1 refactor: –≤—ã–Ω–µ—Å—Ç–∏ IPC-–∫–æ–Ω—Ç—Ä–∞–∫—Ç—ã –∏ telemetry bridge (PR2, ~2‚Äì4 –¥–Ω—è).
3. P2 perf: –æ–≥—Ä–∞–Ω–∏—á–∏—Ç—å `list`, –±–∞—Ç—á–∏—Ç—å —Ç–µ–ª–µ–º–µ—Ç—Ä–∏—é, —Ä–µ—Ñ–∞–∫—Ç–æ—Ä `MapWorkspace` (PR3+, —ç–≤–æ–ª—é—Ü–∏–æ–Ω–Ω–æ).

## –¢–µ—Å—Ç—ã –∏ –≤–∞–ª–∏–¥–∞—Ü–∏—è
- –î–æ–±–∞–≤–∏—Ç—å unit-—Ç–µ—Å—Ç—ã –¥–ª—è –Ω–æ–≤—ã—Ö –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π (`fileStore` allowlist, URL handler).
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ smoke tests: `electron:dev` + —Å–∏–º—É–ª—è—Ç–æ—Ä (`tools/*`) –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ telemetry –ø—Ä–∏ –Ω–∞–≥—Ä—É–∑–∫–µ.

---

## –ü—Ä–∏–ª–æ–∂–µ–Ω–∏—è ‚Äî –∫–ª—é—á–µ–≤—ã–µ –º–µ—Å—Ç–∞ –≤ –∫–æ–¥–µ
- Security: `electron/main.cjs`, `electron/preload.cjs`, `src/platform/electron/platform.ts`
- Telemetry: `src/features/mission/model/telemetry.ts`, `docs/electron-telemetry-provider.md`
- Platform contracts: `src/platform/contracts.ts`, `src/vite-env.d.ts`
- Large UI surface: `src/pages/MapWorkspace.tsx`

---

–ï—Å–ª–∏ –Ω—É–∂–Ω–æ ‚Äî –º–æ–≥—É –ø–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å PR —Å P0-–ø–∞—Ç—á–µ–º (–º–∞–ª—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ `electron/main.cjs` + —Ç–µ—Å—Ç—ã). –í—ã–±–µ—Ä–∏: 1) —Å–æ–∑–¥–∞—Ç—å PR P0 —Å–µ–π—á–∞—Å, 2) —Å–Ω–∞—á–∞–ª–∞ –æ–±—Å—É–¥–∏—Ç—å –¥–µ—Ç–∞–ª–∏ allowlist-–ø—Ä–∞–≤–∏–ª, –∏–ª–∏ 3) —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –∞—É–¥–∏—Ç –∏ –Ω–∏—á–µ–≥–æ –Ω–µ –º–µ–Ω—è—Ç—å ‚Äî –∏ —è –≤—ã–ø–æ–ª–Ω—é –≤—ã–±—Ä–∞–Ω–Ω–æ–µ –¥–µ–π—Å—Ç–≤–∏–µ.