# feat(integration): Zima navigation device UDP/NMEA GGA telemetry service

## Описание
Добавить сервис для подключения навигационной системы **Zima** и обработки телеметрии (UDP → NMEA GGA). Сервис будет слушать UDP-пакеты, фильтровать NMEA-строки типа GGA и публиковать валидные координаты в приложении.

## Требования интеграции
- Открыть UDP-сокет и слушать на конфигурируемом порту (по умолчанию: 10110 или конфиг).
- Поддерживать прослушивание на всех интерфейсах (или указанном интерфейсе).
- Парсинг NMEA 0183 (ASCII). Фильтр по типа предложения: GGA (`$GPGGA`, `$GNGGA`, `$GLGGA`).
- Извлечь и корректно преобразовать поля широты/долготы с учётом N/S и E/W в десятичные градусы.
- Проверять валидность координат (не пустые, не `0.0`, корректное число).
- Рекомендуется использовать готовую библиотеку NMEA (в Node.js: `nmea-0183` или аналог) для проверки контрольных сумм и парсинга.
- Обеспечить экспорт интерфейса для подписки на обновления позиционных данных (EventEmitter / observable / platform API).
- Логирование ошибок парсинга и сетевых ошибок; безопасное восстановление при некорректных пакетах.
- Юнит и интеграционные тесты (симуляция UDP-пакетов, случаи с битой/неполной строкой, проверка валидности координат).
- Документация: ссылка на спецификацию (ниже) и пример конфигурации.

### Конфигурация
- Источник конфигурации:
  - Использовать существующий механизм хранения настроек приложения (`AppSettings` / `platform`), с поддержкой:
    - UI: настройки в `SettingsDialog` (включение сервиса, порт, интерфейс, autostart)
    - Переменные окружения для производственной среды (например `ZIMA_PORT`, `ZIMA_INTERFACE`, `ZIMA_ENABLED`)
    - Персистентное хранилище настроек (файл или storage API), чтобы настройки сохранялись между запусками
- Формат и поля конфигурации (пример):
  - `zima.enabled: boolean` (по-умолчанию: false)
  - `zima.port: number` (по-умолчанию: 10110)
  - `zima.interface: string` (по-умолчанию: '0.0.0.0')
  - `zima.autostart: boolean`
- Хранение: сохранять в общем хранилище приложения; если такого API нет — добавить методы чтения/записи в `src/platform/*` (контракты).
- Необходимые доработки: проверить/доработать `src/platform/contracts.ts` и `SettingsDialog` для поддержки конфигурации `zima` и добавить в документацию пример конфигурации.

### API / Интерфейс и дополнительные возможности
- Экспортируемые элементы:
  - События: `zima:position` (payload: `{ lat, lon, time, source }`)
  - Методы: `start()`, `stop()`, `reloadConfig()`
  - Метод получения сведений об объекте: `getObjectById(id) -> Object | null`
  - Метод получения сведений о двух объектаах по ID одновременно: `getObjectsByIds(id1, id2) -> { object1, object2 }` — полезно для быстрых сравнений/визуализации и уменьшения числа асинхронных вызовов
- Точки интеграции: expose via platform API / IPC for Electron and web abstraction layer
- Права доступа/безопасность: методы должны учитывать права/контекст вызова (если применимо)

## Критерии приёмки ✅
- [ ] UDP listener реализован и порт конфигурируется
- [ ] GGA-парсинг корректно извлекает координаты и преобразует в decimal degrees
- [ ] Невалидные/нулевые координаты отбрасываются
- [ ] Наличие unit/integration тестов с покрытием ключевых сценариев
- [ ] Публичный интерфейс для других модулей приложения (`EventEmitter`/platform API)
- [ ] Документация и ссылка на спецификацию добавлены
- [ ] Конфигурация `zima` интегрирована в AppSettings и персистится между запусками
- [ ] Контракты `platform`/settings обновлены (или добавлен новый API) для хранения конфигурации
- [ ] Реализован и протестирован метод `getObjectsByIds` (включая граничные случаи)

## Спецификация
Смотреть: `docs/ZIMA_CONNECTION_SPEC.md`

---

_Теги: integration, telemetry, zima_
